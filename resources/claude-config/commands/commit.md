# Claude 命令：Commit

智能创建符合规范的提交，自动验证代码质量并生成提交消息。

## 快速使用

```bash
/commit                           # 标准提交
/commit --no-verify               # 跳过代码检查
/commit --no-push                 # 跳过远程推送
```

## 工作流程

1. **预提交检查** - 运行 lint、build、test（如果这些检查失败，询问用户是否要继续提交或先修复问题）
2. **智能暂存** - 分析相关文件并选择性暂存（如果特定文件已暂存，只提交暂存文件；如果没有文件暂存，自动暂存所有修改和新文件）
3. **测试覆盖检查** - 验证修改文件的测试情况
4. **生成提交消息** - 创建规范的提交信息
5. **自动推送** - 提交后推送到远程仓库（总是使用`git push -u origin xxx` 进行 push，其中 XXX 为远程分支名，推送前要求用户确认，默认为 main）

## 最佳实践

- **提交前验证**：确保代码已检查、正确构建且文档已更新
- **原子提交**：每个提交应包含服务于单一目的的相关更改
- **拆分大更改**：如果更改涉及多个关注点，将其拆分为单独的提交
- **传统提交格式**：使用格式 `<type>: <description>` 或 `<type>(版本): <description>`，其中类型为：
    - `feat`：新功能
    - `fix`：错误修复
    - `docs`：文档更改
    - `style`：代码样式更改（格式化等）
    - `refactor`：既不修复错误也不添加功能的代码更改
    - `perf`：性能改进
    - `test`：添加或修复测试
    - `chore`：对构建过程、工具等的更改
- **版本感知提交**：在版本特定分支（如 `release/v0.1.0`、`hotfix/v1.2.3`）上工作时，版本号会自动提取并以格式 `<type>(版本): <description>` 纳入提交（例如：`feat(0.1.0): 添加新功能`）
- **现在时，祈使语气**：将提交消息编写为命令（例如："add feature" 而不是 "added feature"）
- **简洁的第一行**：第一行保持在 72 个字符以下
- **表情符号**：主要提交类型的表情符号：
    - ✨ `feat`: 新功能
    - 🐛 `fix`: 错误修复
    - 📝 `docs`: 文档
    - 💄 `style`: 格式化
    - ♻️ `refactor`: 重构
    - ⚡️ `perf`: 性能
    - ✅ `test`: 测试
    - 🔧 `chore`: 工具/配置
    - 🚀 `ci`: CI/CD
    - 🗑️ `revert`: 撤销
    - 🚑️ `fix`: 紧急修复
    - 🔒️ `fix`: 安全修复
    - 💚 `fix`: 修复 CI
    - 🔥 `fix`: 删除代码

## 提交指南

分析差异时，考虑基于以下标准拆分提交：

1. **不同关注点**：对代码库不相关部分的更改
2. **不同类型的更改**：混合功能、修复、重构等
3. **文件模式**：对不同类型文件的更改（例如：源代码 vs 文档）
4. **逻辑分组**：分开理解或审查更容易的更改
5. **大小**：非常大、拆分后更清晰的更改

## 提交示例

**标准提交消息：**
- ✨ feat: 添加用户身份验证系统
- 🐛 fix: 修复内存泄漏问题
- 📝 docs: 更新 API 文档
- ♻️ refactor: 重构错误处理逻辑
- 🔧 chore: 更新依赖包版本

**版本感知提交（在版本分支上）：**
- ✨ feat(0.1.0): 添加用户身份验证系统
- 🐛 fix(1.2.3): 修复内存泄漏问题
- 📝 docs(2.0.0): 更新 API 文档

**拆分提交示例：**
- 第一次提交：✨ feat: 添加新功能定义
- 第二次提交：✅ test: 为新功能添加测试
- 第三次提交：📝 docs: 更新相关文档


## 命令选项

- `--no-verify`: 跳过运行预提交检查（lint、build、test）
- `--no-push`: 跳过自动将提交推送到远程仓库

